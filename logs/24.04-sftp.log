sftp-psql-demo-sftp24-1  | debug3: fd 5 is not O_NONBLOCK
sftp-psql-demo-sftp24-1  | debug1: Server will not fork when running in debugging mode.
sftp-psql-demo-sftp24-1  | debug3: process_channel_timeouts: setting 0 timeouts
sftp-psql-demo-sftp24-1  | debug3: channel_clear_timeouts: clearing
sftp-psql-demo-sftp24-1  | Connection from 192.168.48.1 port 43040 on 192.168.48.3 port 22 rdomain ""
sftp-psql-demo-sftp24-1  | debug1: Local version string SSH-2.0-OpenSSH_9.6p1 Ubuntu-3ubuntu13.5
sftp-psql-demo-sftp24-1  | debug1: Remote protocol version 2.0, remote software version OpenSSH_8.9p1 Ubuntu-3ubuntu0.10
sftp-psql-demo-sftp24-1  | debug1: compat_banner: match: OpenSSH_8.9p1 Ubuntu-3ubuntu0.10 pat OpenSSH* compat 0x04000000
sftp-psql-demo-sftp24-1  | debug2: fd 5 setting O_NONBLOCK
sftp-psql-demo-sftp24-1  | debug3: ssh_sandbox_init: preparing seccomp filter sandbox
sftp-psql-demo-sftp24-1  | debug2: Network child is on pid 57
sftp-psql-demo-sftp24-1  | debug3: preauth child monitor started
sftp-psql-demo-sftp24-1  | debug3: privsep user:group 100:65534 [preauth]
sftp-psql-demo-sftp24-1  | debug1: permanently_set_uid: 100/65534 [preauth]
sftp-psql-demo-sftp24-1  | debug3: ssh_sandbox_child: setting PR_SET_NO_NEW_PRIVS [preauth]
sftp-psql-demo-sftp24-1  | debug3: ssh_sandbox_child: attaching seccomp filter program [preauth]
sftp-psql-demo-sftp24-1  | debug3: append_hostkey_type: ssh-rsa key not permitted by HostkeyAlgorithms [preauth]
sftp-psql-demo-sftp24-1  | debug1: list_hostkey_types: rsa-sha2-512,rsa-sha2-256,ecdsa-sha2-nistp256,ssh-ed25519 [preauth]
sftp-psql-demo-sftp24-1  | debug3: send packet: type 20 [preauth]
sftp-psql-demo-sftp24-1  | debug1: SSH2_MSG_KEXINIT sent [preauth]
sftp-psql-demo-sftp24-1  | debug3: receive packet: type 20 [preauth]
sftp-psql-demo-sftp24-1  | debug1: SSH2_MSG_KEXINIT received [preauth]
sftp-psql-demo-sftp24-1  | debug2: local server KEXINIT proposal [preauth]
sftp-psql-demo-sftp24-1  | debug2: KEX algorithms: sntrup761x25519-sha512@openssh.com,curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256,ext-info-s,kex-strict-s-v00@openssh.com [preauth]
sftp-psql-demo-sftp24-1  | debug2: host key algorithms: rsa-sha2-512,rsa-sha2-256,ecdsa-sha2-nistp256,ssh-ed25519 [preauth]
sftp-psql-demo-sftp24-1  | debug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com [preauth]
sftp-psql-demo-sftp24-1  | debug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com [preauth]
sftp-psql-demo-sftp24-1  | debug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1 [preauth]
sftp-psql-demo-sftp24-1  | debug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1 [preauth]
sftp-psql-demo-sftp24-1  | debug2: compression ctos: none,zlib@openssh.com [preauth]
sftp-psql-demo-sftp24-1  | debug2: compression stoc: none,zlib@openssh.com [preauth]
sftp-psql-demo-sftp24-1  | debug2: languages ctos:  [preauth]
sftp-psql-demo-sftp24-1  | debug2: languages stoc:  [preauth]
sftp-psql-demo-sftp24-1  | debug2: first_kex_follows 0  [preauth]
sftp-psql-demo-sftp24-1  | debug2: reserved 0  [preauth]
sftp-psql-demo-sftp24-1  | debug2: peer client KEXINIT proposal [preauth]
sftp-psql-demo-sftp24-1  | debug2: KEX algorithms: curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,sntrup761x25519-sha512@openssh.com,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256,ext-info-c,kex-strict-c-v00@openssh.com [preauth]
sftp-psql-demo-sftp24-1  | debug2: host key algorithms: ssh-ed25519-cert-v01@openssh.com,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com,sk-ssh-ed25519-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com,rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-ed25519,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,sk-ssh-ed25519@openssh.com,sk-ecdsa-sha2-nistp256@openssh.com,rsa-sha2-512,rsa-sha2-256 [preauth]
sftp-psql-demo-sftp24-1  | debug2: ciphers ctos: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com [preauth]
sftp-psql-demo-sftp24-1  | debug2: ciphers stoc: chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com [preauth]
sftp-psql-demo-sftp24-1  | debug2: MACs ctos: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1 [preauth]
sftp-psql-demo-sftp24-1  | debug2: MACs stoc: umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1 [preauth]
sftp-psql-demo-sftp24-1  | debug2: compression ctos: none,zlib@openssh.com,zlib [preauth]
sftp-psql-demo-sftp24-1  | debug2: compression stoc: none,zlib@openssh.com,zlib [preauth]
sftp-psql-demo-sftp24-1  | debug2: languages ctos:  [preauth]
sftp-psql-demo-sftp24-1  | debug2: languages stoc:  [preauth]
sftp-psql-demo-sftp24-1  | debug2: first_kex_follows 0  [preauth]
sftp-psql-demo-sftp24-1  | debug2: reserved 0  [preauth]
sftp-psql-demo-sftp24-1  | debug3: kex_choose_conf: will use strict KEX ordering [preauth]
sftp-psql-demo-sftp24-1  | debug1: kex: algorithm: curve25519-sha256 [preauth]
sftp-psql-demo-sftp24-1  | debug1: kex: host key algorithm: ssh-ed25519 [preauth]
sftp-psql-demo-sftp24-1  | debug1: kex: client->server cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: none [preauth]
sftp-psql-demo-sftp24-1  | debug1: kex: server->client cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: none [preauth]
sftp-psql-demo-sftp24-1  | debug1: expecting SSH2_MSG_KEX_ECDH_INIT [preauth]
sftp-psql-demo-sftp24-1  | debug3: receive packet: type 30 [preauth]
sftp-psql-demo-sftp24-1  | debug1: SSH2_MSG_KEX_ECDH_INIT received [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_sshkey_sign: entering [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_send: entering, type 6 [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_sshkey_sign: waiting for MONITOR_ANS_SIGN [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_receive_expect: entering, type 7 [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_receive: entering [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_receive: entering
sftp-psql-demo-sftp24-1  | debug3: monitor_read: checking request 6
sftp-psql-demo-sftp24-1  | debug3: mm_answer_sign: entering
sftp-psql-demo-sftp24-1  | debug3: mm_answer_sign: ssh-ed25519 KEX signature len=83
sftp-psql-demo-sftp24-1  | debug3: mm_request_send: entering, type 7
sftp-psql-demo-sftp24-1  | debug2: monitor_read: 6 used once, disabling now
sftp-psql-demo-sftp24-1  | debug3: send packet: type 31 [preauth]
sftp-psql-demo-sftp24-1  | debug3: send packet: type 21 [preauth]
sftp-psql-demo-sftp24-1  | debug1: ssh_packet_send2_wrapped: resetting send seqnr 3 [preauth]
sftp-psql-demo-sftp24-1  | debug2: ssh_set_newkeys: mode 1 [preauth]
sftp-psql-demo-sftp24-1  | debug1: rekey out after 134217728 blocks [preauth]
sftp-psql-demo-sftp24-1  | debug1: SSH2_MSG_NEWKEYS sent [preauth]
sftp-psql-demo-sftp24-1  | debug1: Sending SSH2_MSG_EXT_INFO [preauth]
sftp-psql-demo-sftp24-1  | debug3: send packet: type 7 [preauth]
sftp-psql-demo-sftp24-1  | debug1: expecting SSH2_MSG_NEWKEYS [preauth]
sftp-psql-demo-sftp24-1  | debug3: receive packet: type 21 [preauth]
sftp-psql-demo-sftp24-1  | debug1: ssh_packet_read_poll2: resetting read seqnr 3 [preauth]
sftp-psql-demo-sftp24-1  | debug1: SSH2_MSG_NEWKEYS received [preauth]
sftp-psql-demo-sftp24-1  | debug2: ssh_set_newkeys: mode 0 [preauth]
sftp-psql-demo-sftp24-1  | debug1: rekey in after 134217728 blocks [preauth]
sftp-psql-demo-sftp24-1  | debug1: KEX done [preauth]
sftp-psql-demo-sftp24-1  | debug3: receive packet: type 5 [preauth]
sftp-psql-demo-sftp24-1  | debug3: send packet: type 6 [preauth]
sftp-psql-demo-sftp24-1  | debug3: receive packet: type 50 [preauth]
sftp-psql-demo-sftp24-1  | debug1: userauth-request for user test service ssh-connection method none [preauth]
sftp-psql-demo-sftp24-1  | debug1: attempt 0 failures 0 [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_getpwnamallow: entering [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_send: entering, type 8 [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_getpwnamallow: waiting for MONITOR_ANS_PWNAM [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_receive_expect: entering, type 9 [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_receive: entering [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_receive: entering
sftp-psql-demo-sftp24-1  | debug3: monitor_read: checking request 8
sftp-psql-demo-sftp24-1  | debug3: mm_answer_pwnamallow: entering
sftp-psql-demo-sftp24-1  | debug2: parse_server_config_depth: config reprocess config len 3258
sftp-psql-demo-db-1      | 2024-10-03 15:40:22.115 MST [45] LOG:  execute <unnamed>: SELECT login AS username,'x' as passwd,login as gecos,'/home/' || login AS homedir,'/bin/bash' as shell,uid,uid as gid FROM sftp_users WHERE login = $1
sftp-psql-demo-db-1      | 2024-10-03 15:40:22.115 MST [45] DETAIL:  parameters: $1 = 'test'
sftp-psql-demo-sftp24-1  | debug3: mm_answer_pwnamallow: sending MONITOR_ANS_PWNAM: 1
sftp-psql-demo-sftp24-1  | debug3: mm_request_send: entering, type 9
sftp-psql-demo-sftp24-1  | debug2: monitor_read: 8 used once, disabling now
sftp-psql-demo-sftp24-1  | debug3: process_channel_timeouts: setting 0 timeouts [preauth]
sftp-psql-demo-sftp24-1  | debug3: channel_clear_timeouts: clearing [preauth]
sftp-psql-demo-sftp24-1  | debug2: input_userauth_request: setting up authctxt for test [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_start_pam entering [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_send: entering, type 100 [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_inform_authserv: entering [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_send: entering, type 4 [preauth]
sftp-psql-demo-sftp24-1  | debug2: input_userauth_request: try method none [preauth]
sftp-psql-demo-sftp24-1  | debug3: userauth_finish: failure partial=0 next methods="publickey,password" [preauth]
sftp-psql-demo-sftp24-1  | debug3: send packet: type 51 [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_receive: entering
sftp-psql-demo-sftp24-1  | debug3: monitor_read: checking request 100
sftp-psql-demo-sftp24-1  | debug1: PAM: initializing for "test"
sftp-psql-demo-sftp24-1  | debug1: PAM: setting PAM_RHOST to "192.168.48.1"
sftp-psql-demo-sftp24-1  | debug1: PAM: setting PAM_TTY to "ssh"
sftp-psql-demo-sftp24-1  | debug2: monitor_read: 100 used once, disabling now
sftp-psql-demo-sftp24-1  | debug3: receive packet: type 50 [preauth]
sftp-psql-demo-sftp24-1  | debug1: userauth-request for user test service ssh-connection method publickey [preauth]
sftp-psql-demo-sftp24-1  | debug1: attempt 1 failures 0 [preauth]
sftp-psql-demo-sftp24-1  | debug2: input_userauth_request: try method publickey [preauth]
sftp-psql-demo-sftp24-1  | debug2: userauth_pubkey: valid user test querying public key rsa-sha2-512 AAAAB3NzaC1yc2EAAAADAQABAAABAQC89c5CYdxTRkKtYhr1/RGJqaxyGI3FWU3M8hwoGP95nv6f0bBoDMIjOZur9w/d+x3qyl7fhnfzbAqaYnl0I3+a1/Jy8R8461Rz/vGXwaLf04zb+cjnj6umvTcLbcYNeJGxdPt6kAtTEeI2hZJaLlz5wxYqHu6/nFzt9PlssIIetuIzdQq9sTEMHcp4l9vCYPhcCpFTrnhpuS7zf9luQLwgKJt9uTo2zF/5lgCsmGxAEISshOAaSEq368fcCpPaM2TuKP8PIENLRt0gkyFFQG7U2wv0aeQ3OpLZV8qHrMXm8jiELSfB3rEfPBgs64RayLc49GDDaUAZiwpgfgG11Ufp [preauth]
sftp-psql-demo-sftp24-1  | debug1: userauth_pubkey: publickey test pkalg rsa-sha2-512 pkblob RSA SHA256:b2pxuFuee6Ui1j9d1RefDjlzYM9iH9mx8H99OrraIuw [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_key_allowed: entering [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_send: entering, type 22 [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_key_allowed: waiting for MONITOR_ANS_KEYALLOWED [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_receive_expect: entering, type 23 [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_receive: entering [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_receive: entering
sftp-psql-demo-sftp24-1  | debug3: monitor_read: checking request 4
sftp-psql-demo-sftp24-1  | debug3: mm_answer_authserv: service=ssh-connection, style=, role=
sftp-psql-demo-sftp24-1  | debug2: monitor_read: 4 used once, disabling now
sftp-psql-demo-sftp24-1  | debug3: mm_request_receive: entering
sftp-psql-demo-sftp24-1  | debug3: monitor_read: checking request 22
sftp-psql-demo-sftp24-1  | debug3: mm_answer_keyallowed: entering
sftp-psql-demo-sftp24-1  | debug1: temporarily_use_uid: 1982/1982 (e=0/0)
sftp-psql-demo-db-1      | 2024-10-03 15:40:22.131 MST [46] LOG:  execute <unnamed>: SELECT uid AS gid FROM sftp_users WHERE login = $1 AND uid <> $2
sftp-psql-demo-db-1      | 2024-10-03 15:40:22.131 MST [46] DETAIL:  parameters: $1 = 'test', $2 = '1982'
sftp-psql-demo-sftp24-1  | debug1: trying public key file /home/test/.ssh/authorized_keys
sftp-psql-demo-sftp24-1  | debug1: Could not open user 'test' authorized keys '/home/test/.ssh/authorized_keys': No such file or directory
sftp-psql-demo-sftp24-1  | debug1: restore_uid: 0/0
sftp-psql-demo-sftp24-1  | debug1: temporarily_use_uid: 1982/1982 (e=0/0)
sftp-psql-demo-sftp24-1  | debug1: trying public key file /home/test/.ssh/authorized_keys2
sftp-psql-demo-sftp24-1  | debug1: Could not open user 'test' authorized keys '/home/test/.ssh/authorized_keys2': No such file or directory
sftp-psql-demo-sftp24-1  | debug1: restore_uid: 0/0
sftp-psql-demo-sftp24-1  | debug3: mm_answer_keyallowed: publickey authentication test: RSA key is not allowed
sftp-psql-demo-sftp24-1  | Failed publickey for test from 192.168.48.1 port 43040 ssh2: RSA SHA256:b2pxuFuee6Ui1j9d1RefDjlzYM9iH9mx8H99OrraIuw
sftp-psql-demo-sftp24-1  | debug3: mm_request_send: entering, type 23
sftp-psql-demo-sftp24-1  | debug2: userauth_pubkey: authenticated 0 pkalg rsa-sha2-512 [preauth]
sftp-psql-demo-sftp24-1  | debug3: user_specific_delay: user specific delay 0.000ms [preauth]
sftp-psql-demo-sftp24-1  | debug3: ensure_minimum_time_since: elapsed 14.507ms, delaying 9.913ms (requested 6.105ms) [preauth]
sftp-psql-demo-sftp24-1  | debug3: userauth_finish: failure partial=0 next methods="publickey,password" [preauth]
sftp-psql-demo-sftp24-1  | debug3: send packet: type 51 [preauth]
sftp-psql-demo-sftp24-1  | debug3: receive packet: type 50 [preauth]
sftp-psql-demo-sftp24-1  | debug1: userauth-request for user test service ssh-connection method password [preauth]
sftp-psql-demo-sftp24-1  | debug1: attempt 2 failures 1 [preauth]
sftp-psql-demo-sftp24-1  | debug2: input_userauth_request: try method password [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_auth_password: entering [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_send: entering, type 12 [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_auth_password: waiting for MONITOR_ANS_AUTHPASSWORD [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_receive_expect: entering, type 13 [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_receive: entering [preauth]
sftp-psql-demo-sftp24-1  | debug3: mm_request_receive: entering
sftp-psql-demo-sftp24-1  | debug3: monitor_read: checking request 12
sftp-psql-demo-sftp24-1  | debug3: PAM: sshpam_passwd_conv called with 1 messages
sftp-psql-demo-db-1      | 2024-10-03 15:40:25.789 MST [49] LOG:  execute <unnamed>: select "password" from sftp_users where login = $1
sftp-psql-demo-db-1      | 2024-10-03 15:40:25.789 MST [49] DETAIL:  parameters: $1 = 'test'
sftp-psql-demo-sftp24-1  | mm_log_handler: write: Broken pipe
sftp-psql-demo-sftp24-1  | debug1: do_cleanup
sftp-psql-demo-sftp24-1  | debug3: PAM: sshpam_thread_cleanup entering
sftp-psql-demo-sftp24-1  | Segmentation fault (core dumped)
sftp-psql-demo-sftp24-1  | SFTP server is exiting.
sftp-psql-demo-sftp24-1 exited with code 0
